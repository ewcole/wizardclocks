<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Stork Plane Pregnancy Timeline</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- Use jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <style type="text/css">
      #widget-text {
          width: 610px;
          height: 80px;
      }
    </style>
  </head>
  <body>
    <article>
      <h1>Stork Plane Pregnancy Timeline</h1>
      <p>
        This clock is a favorite of mine, which I developed to track my second
        son's pregnancy.  You can add it to your own website by entering the 
        due date below.
      </p>
      <div id="sample-div">
      </div>
      <div id="pregnancy-timeline-widget">
        <div id="pregnancy-timeline"/>
        <script type="text/javascript" src="embedTimeline.js">
        </script>
        <script type="text/javascript">
          embedTimeline('sample-div',
          '06/03/2016', '');
        </script>
      </div>
      <div id="widget-sample-div">
        <div id="widget"/>
            <!--
            <div id="widget-template" style="display: none;">
            <script-template type="template/javascript" src="${root}embedTimeline.js">
            </script>
            <script-template type="template/javascript">
            embedTimeline('${divId}',
            '${dueDate}', '${root}');
            </script>
            </div>-->
            
      </div>   
      <div id="widget-generator">
        <form id="widget-form" target="#sample-div">
          <label for="dueDate">Due Date:</label>
          <input id="dueDate" type="date" name="dueDate"/>
          <input type="submit" value="Generate Widget"/>
          <p>
          </p>
        </form>
        <!-- <label for="widget-text"> -->
          <p>Copy this code and paste it into your web page.</p>
        <!-- </label> -->
        <textarea id="widget-text" name="widget-text"
                  placeholder="Your widget code will appear here">
        </textarea>
        <!-- <div id="widget-text"></div> -->
        <script type="text/javascript">
          $(function() {
              $('#dueDate').datepicker();
              $('#widget-form').submit(
                  function (data) {
                      var root = document.location.protocol + '//' +
                                 document.location.host + 
                                 document.location.pathname.replace(/[^\/]*$/,'');
                      // Create the widget
                      var divId = 'pregnancy-timeline';
                      var sampleDiv = $('#sample-div');
                      sampleDiv.html('');
                      var widgetWrapper = $('<div id="' + divId + '-wrapper">');
                      var widget = $('<div id="' + divId + '">');
                      widgetWrapper.append(widget)
                      var embedTimelineSrc = root + 'embedTimeline.js';
                      var scriptTag = '<script src="' + embedTimelineSrc + '">';
                      widgetWrapper.append($(scriptTag));
                      var embedStr = "embedTimeline('" + divId + "', " +
                                       "'" + $('#dueDate').val() + "'," +
                                       "'" + root + "');";
                      scriptTag = $('<script type="text/javascript">');
                      scriptTag.text(embedStr);
                      widgetWrapper.append(scriptTag);
                      $('#widget-text').val(widgetWrapper.html())
                      sampleDiv.append(widgetWrapper);
                      $('#widget-text').focus();
                      $('#widget-text').select();
                      return false;
                  }
              );
          })
        </script>
      </div>
    </article>
  </body>
</html>
